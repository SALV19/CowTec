<!-- KPI Card Molecule -->
<div class="card kpi-card bg-<%= typeof bgColor !== 'undefined' ? bgColor : 'primary' %> text-white border-0 shadow-lg<%= typeof additionalClasses !== 'undefined' && additionalClasses ? ' ' + additionalClasses : '' %>" style="background: <%= typeof gradient !== 'undefined' && gradient ? gradient : 'linear-gradient(135deg, var(--bs-' + (typeof bgColor !== 'undefined' ? bgColor : 'primary') + ') 0%, var(--bs-' + (typeof bgColor !== 'undefined' ? bgColor : 'primary') + ') 100%)' %>;">
  <div class="card-body p-4">
    <div class="d-flex justify-content-between align-items-start">
      <div class="kpi-content">
        <h6 class="card-title mb-2 opacity-90 fw-normal"><%= title %></h6>
        <div class="kpi-value-wrapper">
          <h2 class="mb-0 fw-bold" id="<%= id %>">
            <%- include('../atoms/kpi-value', { 
              value: value, 
              prefix: typeof prefix !== 'undefined' ? prefix : undefined, 
              suffix: typeof suffix !== 'undefined' ? suffix : undefined,
              id: typeof valueId !== 'undefined' ? valueId : undefined
            }) %>
          </h2>
        </div>
        <% if (typeof change !== 'undefined' && change) { %>
          <div class="kpi-change mt-2">
            <%- include('../atoms/badge', { 
              text: change, 
              variant: 'light',
              additionalClasses: 'bg-white bg-opacity-25 text-white',
              icon: (typeof changeType !== 'undefined' && changeType) === 'increase' ? 'arrow-up' : 'arrow-down'
            }) %>
          </div>
        <% } %>
      </div>
      <div class="kpi-icon align-self-center">
        <div class="icon-wrapper bg-white bg-opacity-20 rounded-circle p-3">
          <%- include('../atoms/icon', { name: icon, additionalClasses: 'fa-2x' }) %>
        </div>
      </div>
    </div>
    
    <!-- Optional progress indicator -->
    <% if (typeof progress !== 'undefined' && progress) { %>
      <div class="mt-3">
        <%- include('../atoms/progress', { 
          value: progress.value,
          height: '4px',
          variant: 'light',
          additionalClasses: 'bg-white bg-opacity-20'
        }) %>
        <small class="opacity-75 mt-1 d-block"><%= progress.label || 'Progress' %></small>
      </div>
    <% } %>
  </div>
  
  <!-- Decorative elements -->
  <div class="card-decoration position-absolute" style="top: 1rem; right: 1rem; opacity: 0.1;">
    <%- include('../atoms/icon', { name: icon, additionalClasses: 'fa-3x' }) %>
  </div>
</div>